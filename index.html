<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SecurePass | Zero-Knowledge WebVault</title>
    <link rel="stylesheet" href="src/theme.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono&display=swap"
        rel="stylesheet">
</head>

<body class="light-mode">
    <header>
        <h1>SecurePass</h1>
        <p>Zero-Knowledge Architecture | Argon2id + AES-256-GCM</p>
        <div class="header-theme-toggle">
            <theme-toggle global></theme-toggle>
        </div>
    </header>

    <main class="auth-view">
        <div id="app" class="auth-mode">
            <!-- ========== AUTHENTICATION VIEW ========== -->
            <section id="auth-section">
                <div class="auth-card-inner">
                    <label class="label-caps">Identity Vault Access</label>
                    <input type="password" id="master-pwd" placeholder="Enter Master Password" autofocus>
                    <div class="auth-actions">
                        <button id="unlock-btn" class="btn-primary">Unlock Vault</button>
                        <button id="bio-btn" class="btn-outline hidden">FaceID / TouchID</button>
                    </div>
                </div>

                <div class="features-grid">
                    <div class="feature-item">
                        <strong>Rust/Wasm Engine</strong>
                        <p>Core cryptography and TOTP generation isolated in a high-performance Wasm sandbox.</p>
                    </div>
                    <div class="feature-item">
                        <strong>Argon2id KDF</strong>
                        <p>Military-grade key derivation resistant to GPU/ASIC cracking for maximum master key safety.
                        </p>
                    </div>
                    <div class="feature-item">
                        <strong>AES-256-GCM</strong>
                        <p>All data is sealed with authenticated encryption, ensuring both confidentiality and data
                            integrity.</p>
                    </div>
                    <div class="feature-item">
                        <strong>Smart Generator</strong>
                        <p>Rust-backed entropy engine with guaranteed character diversity for uncrackable passwords.</p>
                    </div>
                </div>
            </section>

            <!-- ========== VAULT VIEW ========== -->
            <section id="vault-content" class="hidden">
                <div id="decoy-indicator" class="hidden">‚ö†Ô∏è DECOY WALLET ACTIVE</div>

                <!-- Sidebar -->
                <aside class="sidebar" id="sidebar-container">
                    <div class="sidebar-header">
                        <h2>SecureVault</h2>
                    </div>
                    <div class="category-list" id="category-list">
                        <!-- Populated by VaultSidebar -->
                    </div>
                    <div class="sidebar-footer">
                        <button id="enable-bio-btn" class="btn-ghost" style="width: 100%; justify-content: flex-start;">
                            <span>üõ°Ô∏è Security Hub</span>
                        </button>
                    </div>
                </aside>

                <!-- Main ContentArea -->
                <div class="main-content">
                    <!-- Toolbar (Persistent) -->
                    <div class="toolbar">
                        <div class="toolbar-left">
                            <div class="search-box">
                                <span class="search-icon"></span>
                                <input type="text" id="search-input" placeholder="Search vault...">
                            </div>
                            <button id="new-entry-btn" class="btn-primary">
                                <span>Add Entry</span>
                            </button>
                            <button id="save-btn" class="btn-primary">
                                Save Vault
                            </button>
                        </div>

                        <div class="toolbar-right">
                            <button id="dashboard-toggle-btn" class="btn-outline"
                                title="Security Insights">Insights</button>
                            <button id="export-btn" class="btn-outline" title="Download Backup">Export</button>
                            <theme-toggle></theme-toggle>
                            <button id="lock-btn" class="btn-outline">Lock</button>
                        </div>
                    </div>

                    <!-- Vault Table View -->
                    <div id="vault-table-view">
                        <div class="table-container">
                            <table class="passwords-table">
                                <thead>
                                    <tr>
                                        <th style="width: 60px;"></th>
                                        <th>Service</th>
                                        <th>Category</th>
                                        <th>Username / Email</th>
                                        <th style="width: 100px;">2FA</th>
                                        <th style="width: 100px;">Security</th>
                                        <th style="width: 110px;">Breach</th>
                                        <th style="width: 120px;">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="vault-table-body">
                                    <!-- Entries will be populated by VaultTable component -->
                                </tbody>
                            </table>

                            <!-- Empty State -->
                            <div id="empty-state" class="empty-state hidden">
                                <div class="empty-state-icon">üîê</div>
                                <h3>No passwords yet</h3>
                                <p>Click "New Password" to add your first entry</p>
                            </div>
                        </div>
                    </div>

                    <!-- Security Dashboard View -->
                    <div id="security-dashboard-container" class="hidden">
                        <security-dashboard></security-dashboard>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- ============ ENTRY EDITOR MODAL ============ -->
    <div id="entry-modal" class="modal-overlay hidden">
        <div class="modal-content" style="max-width: 500px;">
            <h2 style="margin-top: 0;" id="modal-title">New Password Entry</h2>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                <div class="form-group">
                    <label class="label-caps">Service Name</label>
                    <input type="text" id="entry-title" placeholder="e.g., GitHub, Gmail">
                </div>
                <div class="form-group">
                    <label class="label-caps">Category</label>
                    <select id="entry-category" class="select-minimal"
                        style="width: 100%; border: 1px solid var(--border); border-radius: 8px; padding: 12px; background: var(--form-bg); color: var(--text);">
                        <option value="personal">Personal</option>
                        <option value="work">Work</option>
                        <option value="finance">Finance</option>
                        <option value="social">Social</option>
                        <option value="other">Other</option>
                    </select>
                </div>
            </div>

            <div style="margin-top: 16px;">
                <label class="label-caps">Username / Email</label>
                <input type="text" id="entry-username" placeholder="Optional">
            </div>

            <div style="margin-top: 16px;">
                <label class="label-caps">Password</label>
                <div style="display: flex; gap: 8px; margin-bottom: 8px;">
                    <input type="text" id="new-password" placeholder="Password" style="flex: 1; margin: 0;">
                    <button id="gen-btn" class="btn-primary" title="Regenerate Password"
                        style="padding: 0 12px;">Regen</button>
                </div>

                <!-- Generator Options UI -->
                <div id="gen-options"
                    style="background: var(--bg-secondary); padding: 12px; border-radius: 8px; border: 1px solid var(--border); font-size: 13px;">
                    <div style="margin-bottom: 12px;">
                        <label style="font-size: 11px; opacity: 0.6; display: block; margin-bottom: 4px;">FORMAT</label>
                        <select id="gen-type" class="select-minimal"
                            style="width: 100%; padding: 6px; border-radius: 4px;">
                            <option value="standard">Standard (Random)</option>
                            <option value="mac">Mac OS Style (xxx-xxx-xxx)</option>
                            <option value="passphrase">Passphrase (Words)</option>
                        </select>
                    </div>

                    <div id="gen-std-options">
                        <div style="margin-bottom: 12px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                <label style="font-size: 11px; opacity: 0.6;">LENGTH: <span
                                        id="gen-length-val">20</span></label>
                            </div>
                            <input type="range" id="gen-length" min="8" max="64" value="20"
                                style="width: 100%; height: 4px; margin: 8px 0;">
                        </div>

                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px;">
                            <label style="display: flex; align-items: center; gap: 6px; cursor: pointer;">
                                <input type="checkbox" id="gen-upper" checked style="width: auto; margin: 0;"> Upper
                            </label>
                            <label style="display: flex; align-items: center; gap: 6px; cursor: pointer;">
                                <input type="checkbox" id="gen-numbers" checked style="width: auto; margin: 0;"> Numbers
                            </label>
                            <label style="display: flex; align-items: center; gap: 6px; cursor: pointer;">
                                <input type="checkbox" id="gen-symbols" checked style="width: auto; margin: 0;"> Symbols
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-top: 16px;">
                <div class="form-group">
                    <label class="label-caps">2FA Secret (TOTP)</label>
                    <input type="text" id="totp-secret" placeholder="Base32 Key" style="margin: 0;">
                </div>
                <div class="form-group" style="display: flex; align-items: flex-end; padding-bottom: 12px;">
                    <label
                        style="display: flex; align-items: center; gap: 8px; cursor: pointer; font-size: 13px; font-weight: 600;">
                        <input type="checkbox" id="entry-favorite" style="width: auto; margin: 0;"> Add to Favorites
                    </label>
                </div>
            </div>

            <div style="margin-top: 16px;">
                <label class="label-caps">Encrypted Notes</label>
                <textarea id="entry-notes" placeholder="Private notes..."
                    style="width: 100%; min-height: 80px; padding: 12px; border-radius: 8px; border: 1px solid var(--border); background: var(--form-bg); color: var(--text); resize: vertical;"></textarea>
            </div>

            <div id="history-section" class="hidden"
                style="margin-top: 16px; padding-top: 16px; border-top: 1px solid var(--border);">
                <label class="label-caps">Password History</label>
                <div id="history-list" style="max-height: 120px; overflow-y: auto;"></div>
            </div>

            <div style="display: flex; justify-content: flex-end; gap: 12px; margin-top: 24px;">
                <button id="modal-cancel-btn" class="btn-outline">Cancel</button>
                <button id="add-btn" class="btn-primary">Save Entry</button>
            </div>
        </div>
    </div>

    <!-- ============ BIOMETRIC SETUP MODAL ============ -->
    <!-- Managed by BiometricAuth in main.ts -->

    <!-- ============ DURESS MODE COMPONENT ============ -->
    <duress-mode></duress-mode>

    <footer>
        <p>&copy; 2026 SecurePass Identity. All data is encrypted locally using Wasm/AES-GCM.</p>
        <div style="display: flex; justify-content: center; gap: 12px; margin-top: 8px;">
            <span id="status-dot" style="background: #10b981;"></span>
            <span style="opacity: 0.6;">Local-Only Mode Active</span>
        </div>
    </footer>

    <!-- Initializer scripts -->
    <script type="module" src="src/main.ts"></script>
</body>

</html>